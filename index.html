<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>Simple GL Shader Test</title>
        <meta http-equiv="refresh" content="30">
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="style.css">
        <script src="js/three.js"></script>
        <script src="js/dwin/main.js"></script>
        <script src="js/dwin/logging.js"></script>
        
        <script src="js/dwin/shaders/vertexShader.js"></script>
        <script src="js/dwin/shaders/fragmentShader1.js"></script>
        <script src="js/dwin/shaders/fragmentShader2.js"></script>
        
    </head>
    <body>
        <script>
            
        init();
        
        function create()
        {
            var renderTargetParams = {
                    minFilter:THREE.LinearFilter,
                    stencilBuffer:false,
                    depthBuffer:false
            }

            var dataTexture = new THREE.DataTexture(generateRandomData(),height,width,THREE.RGBAFormat);
            dataTexture.needsUpdate = true;

            var uniforms = {
                sTexture: { type: "t", value: dataTexture }
            };

            var attributes = {  
                aPosition: { type: 'v3', value: new THREE.Vector3() }
              };

            var material_FS = new THREE.ShaderMaterial({
                uniforms: uniforms,
                vertexShader: document.getElementById('vertexShader').textContent,
                fragmentShader: document.getElementById('fragmentShader1').textContent
            });

            var mesh = new THREE.Mesh(geometry, material_FS);
            scene.add(mesh);

            var myTexture = new THREE.WebGLRenderTarget( height, width, renderTargetParams );

            renderer.setSize(height, width);
            document.body.appendChild(renderer.domElement);

            renderer.render(scene, camera, myTexture, true);

            var uniforms2 = {
                sTexture: { type: "t", value: myTexture },
                sTexture2: { type: "t", value: dataTexture }
            };

            var material = new THREE.ShaderMaterial({
                uniforms: uniforms2,
                vertexShader: document.getElementById('vertexShader').textContent,
                fragmentShader: document.getElementById('fragmentShader2').textContent
            });

            mesh = new THREE.Mesh(geometry, material);
            scene2.add(mesh);
        }
        create();
        
        var render = function () {
            requestAnimationFrame(render);
            //create();
            renderer.render(scene2, camera);
        }
        
        render();

        </script>
        <div class="logging" id="logging"></div>
        <script>
            initLogging();
            addToConsole("Random Number = " + generateRandomNumber());
        </script>
    </body>
</html>